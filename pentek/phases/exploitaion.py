
import socket
import ipaddress

from core.exploitation_core.exploits import Exploits





class Exploitation:
    def __init__(self,domain,ip,db_handler,mode="web"):
        self.domain = domain
        self.ip = ip
        self.scan_type = "Exploitation"
        self.db_handler = db_handler
        self.mode = mode
    
    def run_network_exploit(self):
        Exploits.run_exploits(self)



    @staticmethod
    def run_exploitation(domain,db_handler,mode):
        ip = ""
        try:
            ipaddress.ip_address(domain)
            ip = domain
            domain = ''

        except:
            ip = socket.gethostbyname(domain)
        obj = Exploitation(domain,ip,db_handler,mode)
        obj.run_network_exploit()
